(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[304],{63:(e,t,a)=>{"use strict";var r=a(7260);a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},5915:(e,t,a)=>{var r={"./en.json":[7092,92],"./es.json":[7543,543],"./pt.json":[2227,227]};function n(e){if(!a.o(r,e))return Promise.resolve().then(()=>{var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=r[e],n=t[0];return a.e(t[1]).then(()=>a.t(n,19))}n.keys=()=>Object.keys(r),n.id=5915,e.exports=n},6042:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>C});var r=a(5155),n=a(2115),o=a(63);let i=e=>{let{id:t,name:a,type:n="text",value:o,onChange:i,onBlur:l,placeholder:s,label:c,error:d,disabled:u=!1,required:m=!1,className:p="",inputClassName:f="",rows:g=3,children:h}=e,y=t||a,b="w-full px-3 py-3 border rounded-md text-sm text-gray-900 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 transition-colors ".concat(d?"border-red-300 focus:ring-red-400 focus:border-red-400":"border-gray-300"," ").concat(f);return(0,r.jsxs)("div",{className:"space-y-2 ".concat(p),children:[c&&(0,r.jsxs)("label",{htmlFor:y,className:"block text-sm font-medium text-gray-700",children:[c,m&&(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(()=>{switch(n){case"select":return(0,r.jsx)("select",{id:y,name:a,value:o,onChange:i,onBlur:l,disabled:u,required:m,className:b,children:h});case"textarea":return(0,r.jsx)("textarea",{id:y,name:a,value:o,onChange:i,onBlur:l,placeholder:s,disabled:u,required:m,rows:g,className:"".concat(b," resize-none")});default:return(0,r.jsx)("input",{id:y,name:a,type:n,value:o,onChange:i,onBlur:l,placeholder:s,disabled:u,required:m,className:b})}})(),d&&(0,r.jsx)("p",{className:"text-sm text-red-600",children:d})]})};var l=a(7101),s=a(8720);function c(e){let{onVerify:t,onError:a,isVerified:o=!1,isLoading:i=!1}=e,[c,d]=(0,n.useState)(!1),{t:u}=(0,s.c)();(0,n.useEffect)(()=>{(()=>{if(window.grecaptcha)return d(!0);let e=document.createElement("script");e.src="https://www.google.com/recaptcha/api.js?render=".concat("test-key"),e.async=!0,e.defer=!0,e.onload=()=>{d(!0)},e.onerror=()=>{null==a||a("Failed to load reCAPTCHA")},document.head.appendChild(e)})()},[a]);let m=(0,n.useCallback)(async()=>{if(!c||!window.grecaptcha){null==a||a("reCAPTCHA not loaded");return}try{let e=await window.grecaptcha.execute("test-key",{action:"purchase_verification"});t(e)}catch(e){null==a||a("reCAPTCHA verification failed")}},[c,t,a]);return(0,r.jsxs)("div",{className:"flex flex-col items-center space-y-2",children:[(0,r.jsx)("label",{className:"text-xs font-medium text-gray-600",children:u("recaptcha.title")}),o?(0,r.jsxs)("div",{className:"flex items-center space-x-2 px-4 py-2 bg-gray-100 border border-gray-300 rounded-md",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:u("recaptcha.verified")})]}):(0,r.jsx)(l.$,{type:"button",onClick:m,disabled:!c||i,loading:i,variant:"secondary",size:"sm",className:"w-auto px-4",children:u(c?"recaptcha.label":"recaptcha.loading")})]})}let d=e=>{var t;let{config:a,formData:o,onChange:d,onSubmit:u,isLoading:m=!1,errors:p={},onCancel:f,className:g="",showRecaptcha:h=!1,recaptchaVerified:y=!1,recaptchaError:b,onRecaptchaVerify:x,onRecaptchaError:v,isDataLoading:_=!1,recaptcha:k}=e,[C,w]=(0,n.useState)(!1),[j,S]=(0,n.useState)({}),{t:E}=(0,s.c)();(0,n.useEffect)(()=>{w(!0)},[]);let N=(e,t)=>{d(e,t),j[e]&&S(t=>{let a={...t};return delete a[e],a})},A=(e,t)=>{let r=a.fields.find(t=>t.id===e);if(r){let a=T(r,t);a?S(t=>({...t,[e]:a})):S(t=>{let a={...t};return delete a[e],a})}},T=(e,t)=>{var a,r,n,o;return e.required&&(!t||""===t.toString().trim())?E((null==(o=e.validation)?void 0:o.message)||"".concat(e.id,"_required")):(null==(a=e.validation)?void 0:a.minLength)&&t&&t.length<e.validation.minLength?E(e.validation.message||"".concat(e.id,"_min_length")):(null==(r=e.validation)?void 0:r.maxLength)&&t&&t.length>e.validation.maxLength?E(e.validation.message||"".concat(e.id,"_max_length")):(null==(n=e.validation)?void 0:n.pattern)&&t&&!new RegExp(e.validation.pattern).test(t)?E(e.validation.message||"".concat(e.id,"_invalid")):null},P=e=>{let t=p[e.id]||j[e.id],a=o[e.id]||"";return"select"===e.type&&e.options?(0,r.jsxs)(i,{type:"select",id:e.id,label:E(e.label),value:a,onChange:t=>N(e.id,t.target.value),onBlur:t=>A(e.id,t.target.value),required:e.required,disabled:e.disabled||_,error:t,children:[(0,r.jsx)("option",{value:"",children:_?E("inputs.loading_options"):E("inputs.select_option")}),C&&e.options&&e.options.length>0&&e.options.map((e,t)=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value||"option-".concat(t)))]},e.id):"textarea"===e.type?(0,r.jsx)(i,{type:"textarea",id:e.id,label:E(e.label),value:a,onChange:t=>N(e.id,t.target.value),onBlur:t=>A(e.id,t.target.value),placeholder:e.placeholder?E(e.placeholder):void 0,required:e.required,disabled:e.disabled,rows:e.rows,error:t},e.id):(0,r.jsx)(i,{type:e.type,id:e.id,label:E(e.label),value:a,onChange:t=>N(e.id,t.target.value),onBlur:t=>A(e.id,t.target.value),placeholder:e.placeholder?E(e.placeholder):void 0,required:e.required,disabled:e.disabled,error:t,className:e.gridCols?"col-span-".concat(e.gridCols):""},e.id)};return(0,r.jsx)("div",{className:"space-y-6 ".concat(g),children:(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(()=>{let e={},t=!0;return a.fields.forEach(a=>{let r=o[a.id],n=T(a,r);n&&(e[a.id]=n,t=!1)}),S(e),t})()&&u(e)},className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-6",children:a.fields.filter(e=>"6"===e.gridCols).map(e=>P(e))}),a.fields.filter(e=>"12"===e.gridCols||!e.gridCols).map(e=>P(e))]}),h&&(0,r.jsxs)("div",{className:"border-t border-gray-200 pt-4",children:[(0,r.jsx)(c,{onVerify:x||(()=>{}),onError:v||(()=>{}),isVerified:y,isLoading:(null==k?void 0:k.isLoading)||!1}),b&&(0,r.jsx)("p",{className:"text-sm text-red-600 mt-2",children:b})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 sm:justify-end",children:[a.cancelButton&&f&&(0,r.jsx)(l.$,{type:"button",onClick:f,variant:a.cancelButton.variant||"secondary",disabled:m,className:"w-full sm:w-auto",children:E(a.cancelButton.text)}),(0,r.jsx)(l.$,{type:"submit",variant:a.submitButton.variant||"primary",disabled:m||!a.fields.every(e=>{if(!e.required)return!0;let t=o[e.id];return t&&""!==t.toString().trim()})||h&&!y,loading:m,className:"w-full sm:w-auto",children:m?E((null==(t=a.submitButton)?void 0:t.loadingText)||""):E(a.submitButton.text)})]})]})})},u={id:"purchase-verification",fields:[{id:"fullname",type:"text",label:"update_information.form.fullname",placeholder:"update_information.form.placeholder_fullname",required:!0,gridCols:"12",validation:{minLength:2,message:"update_information.form.requiered_fullname"}},{id:"country",type:"select",label:"update_information.form.country",required:!0,gridCols:"12",options:[]},{id:"address",type:"textarea",label:"update_information.form.address",placeholder:"update_information.form.placeholder_address",required:!0,rows:3,gridCols:"12",validation:{minLength:10,message:"update_information.form.requiered_address"}}],submitButton:{text:"update_information.form.submit_button",loadingText:"update_information.form.submit_button",variant:"primary"},cancelButton:{text:"update_information.form.cancel_button",variant:"secondary"}},m=[{id:"AR",name:"Argentina"},{id:"BR",name:"Brasil"},{id:"CL",name:"Chile"},{id:"CO",name:"Colombia"},{id:"MX",name:"M\xe9xico"},{id:"PE",name:"Per\xfa"},{id:"UY",name:"Uruguay"},{id:"US",name:"Estados Unidos"},{id:"ES",name:"Espa\xf1a"},{id:"FR",name:"Francia"},{id:"IT",name:"Italia"},{id:"DE",name:"Alemania"},{id:"GB",name:"Reino Unido"},{id:"CA",name:"Canad\xe1"},{id:"AU",name:"Australia"}],p=e=>{let[t,a]=(0,n.useState)(()=>{try{let t=localStorage.getItem(e.key),a=localStorage.getItem(e.timestampKey);if(!t||!a)return null;let r=Date.now(),n=parseInt(a);if(r-n<e.expiryTime)return JSON.parse(t);return localStorage.removeItem(e.key),localStorage.removeItem(e.timestampKey),null}catch(t){return console.error("Error reading ".concat(e.key," from localStorage:"),t),null}}),[r,o]=(0,n.useState)(!1),[i,l]=(0,n.useState)(null),s=(0,n.useCallback)(t=>{try{localStorage.setItem(e.key,JSON.stringify(t)),localStorage.setItem(e.timestampKey,Date.now().toString())}catch(t){console.error("Error saving ".concat(e.key," to localStorage:"),t)}},[e.key,e.timestampKey]),c=(0,n.useCallback)(()=>{try{localStorage.removeItem(e.key),localStorage.removeItem(e.timestampKey),a(null)}catch(t){console.error("Error clearing ".concat(e.key," from localStorage:"),t)}},[e.key,e.timestampKey]),d=(0,n.useCallback)(async()=>{o(!0),l(null);try{let t=await e.fetchData();a(t),s(t)}catch(t){console.error("Error fetching ".concat(e.key,":"),t),l(t instanceof Error?t.message:"Error al cargar ".concat(e.key)),a(e.fallbackData),s(e.fallbackData)}finally{o(!1)}},[e.fetchData,e.fallbackData,s]);return(0,n.useEffect)(()=>{null===t&&d()},[t,d]),{data:t,isLoading:r,error:i,setCachedData:s,clearCache:c,refreshData:d}},f="mercadolibre_auth_token",g=()=>{let[e,t]=(0,n.useState)(null),a=e=>{try{localStorage.setItem(f,e)}catch(e){console.error("Error saving token to localStorage:",e)}},r=(0,n.useCallback)(()=>{try{localStorage.removeItem(f),t(null)}catch(e){console.error("Error clearing token from localStorage:",e)}},[]),o=(0,n.useCallback)(e=>{e&&""!==e.trim()&&(t(e),a(e))},[]),i=(0,n.useCallback)(()=>e?{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}:{"Content-Type":"application/json"},[e]),l=(0,n.useCallback)(()=>!!e,[e]);return(0,n.useEffect)(()=>{let e=(()=>{try{return localStorage.getItem(f)}catch(e){return console.error("Error reading token from localStorage:",e),null}})();e&&t(e)},[]),{token:e,setTokenFromQuery:o,getAuthHeaders:i,hasValidToken:l,clearToken:r,setCachedToken:a}},h={apiBaseUrl:"https://api.mercadolibre.com",useMockData:!0},y=async e=>{let t=await fetch("".concat(h.apiBaseUrl,"/classified_locations/countries"),{headers:e,signal:AbortSignal.timeout(1e4)});return await t.json()},b=async()=>(await new Promise(e=>setTimeout(e,200)),m),x={id:0xc55c246,nickname:"TETE6838590",registration_date:"2016-02-24T15:18:42.000-04:00",first_name:"Pedro",last_name:"Picapiedras",country_id:"AR",email:"test_user_15879541@testuser.com",identification:{type:"DNI",number:"33333333"},address:{state:"AR-C",city:"CapitalFederal",address:"Triunvirato5555",zip_code:"1414"},phone:{area_code:"011",number:"4444-4444",extension:"001",verified:!1},alternative_phone:{area_code:"",number:"",extension:"",verified:!1},user_type:"normal",tags:["normal","test_user","user_info_verified"],logo:null,points:100,site_id:"MLA",permalink:"http://perfil.mercadolibre.com.ar/TETE6838590",shipping_modes:["custom","not_specified"],seller_experience:"ADVANCED",seller_reputation:{level_id:null,power_seller_status:null,transactions:{period:"historic",total:0,completed:0,canceled:0,ratings:{positive:0,negative:0,neutral:0}}},buyer_reputation:{canceled_transactions:0,transactions:{period:"historic",total:null,completed:null,canceled:{total:null,paid:null},unrated:{total:null,paid:null},not_yet_rated:{total:null,paid:null,units:null}},tags:[]},status:{site_status:"active",list:{allow:!0,codes:[],immediate_payment:{required:!1,reasons:[]}},buy:{allow:!0,codes:[],immediate_payment:{required:!1,reasons:[]}},sell:{allow:!0,codes:[],immediate_payment:{required:!1,reasons:[]}},billing:{allow:!0,codes:[]},mercadopago_tc_accepted:!0,mercadopago_account_type:"personal",mercadoenvios:"not_accepted",immediate_payment:!1,confirmed_email:!1,user_type:"simple_registration",required_action:""},credit:{consumed:100,credit_level_id:"MLA1"}},v=async e=>{let{userId:t,headers:a}=e,r=await fetch("".concat(h.apiBaseUrl,"/users/").concat(t),{headers:a,signal:AbortSignal.timeout(1e4)});return await r.json()},_=async()=>(await new Promise(e=>setTimeout(e,300)),x);function k(){let e=(0,o.useRouter)(),t=(0,o.useSearchParams)(),{t:a}=(0,s.c)(),[i,l]=(0,n.useState)({fullname:"",country:"",address:""}),[c,m]=(0,n.useState)(!1),[f,k]=(0,n.useState)(!1),C=function(){let[e,t]=(0,n.useState)(!1),[a,r]=(0,n.useState)(null),[o,i]=(0,n.useState)(null),[l,s]=(0,n.useState)(!1);return{isVerified:e,token:a,error:o,isLoading:l,verify:(0,n.useCallback)(async e=>{if(!e){i("No reCAPTCHA token provided"),t(!1);return}s(!0),i(null);try{let a=await fetch("/api/verify-recaptcha",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})}),n=await a.json();n.success?(r(e),t(!0),i(null)):(i(n.error||"reCAPTCHA verification failed"),t(!1))}catch(e){i("Network error during verification"),t(!1)}finally{s(!1)}},[]),reset:(0,n.useCallback)(()=>{t(!1),r(null),i(null),s(!1)},[]),setError:i}}(),{countries:w,isLoading:j,error:S}=(()=>{let{getAuthHeaders:e,hasValidToken:t}=g(),{data:a,isLoading:r,error:n}=p({key:"mercadolibre_countries_data",timestampKey:"mercadolibre_countries_data_timestamp",expiryTime:6048e5,fallbackData:[{id:"AR",name:"Argentina"},{id:"BR",name:"Brasil"},{id:"CL",name:"Chile"},{id:"CO",name:"Colombia"},{id:"MX",name:"M\xe9xico"},{id:"PE",name:"Per\xfa"},{id:"UY",name:"Uruguay"},{id:"US",name:"Estados Unidos"}],fetchData:async()=>{if(!h.useMockData&&t())try{let t=e(),a=new Headers;return Object.entries(t).forEach(e=>{let[t,r]=e;void 0!==r&&a.set(t,r)}),(await y(a)).countries||[]}catch(e){console.error("Error fetching countries from API, falling back to mock:",e)}return b()}});return{countries:a||[],isLoading:r,error:n}})(),{userData:E,isLoading:N,error:A,getFullName:T,getFullAddress:P}=(e=>{let{getAuthHeaders:t,hasValidToken:a}=g(),{data:r,isLoading:o,error:i}=p({key:"mercadolibre_user_data",timestampKey:"mercadolibre_user_data_timestamp",expiryTime:864e5,fallbackData:x,fetchData:async()=>{if(!h.useMockData&&a()&&e)try{let a=t(),r=new Headers;return Object.entries(a).forEach(e=>{let[t,a]=e;void 0!==a&&r.set(t,a)}),await v({userId:e,headers:r})}catch(e){console.error("Error fetching user data from API, falling back to mock:",e)}return _()}}),l=(0,n.useCallback)(()=>r?"".concat(r.first_name," ").concat(r.last_name).trim():"",[r]),s=(0,n.useCallback)(()=>{if(!r)return"";let{address:e,city:t,state:a}=r.address;return"".concat(e,", ").concat(t,", ").concat(a).trim()},[r]);return{userData:r,isLoading:o,error:i,getFullName:l,getFullAddress:s}})(),{setTokenFromQuery:D,token:B,hasValidToken:L}=g(),I=t.get("referrer"),q=t.get("token");(0,n.useEffect)(()=>{k(!0)},[]),(0,n.useEffect)(()=>{q&&D(q)},[q,D]),(0,n.useEffect)(()=>{E&&!N&&l({fullname:T(),country:E.country_id,address:P()})},[E,N,T,P]);let R={...u,fields:u.fields.map(e=>"country"===e.id?{...e,options:w.map(e=>({value:e.id,label:e.name}))}:e)},U=async t=>{t.preventDefault(),m(!0);try{await new Promise(e=>setTimeout(e,1e3));let t="/confirmation?referrer=".concat(encodeURIComponent(I||""),"&token=").concat(encodeURIComponent(B||""));e.push(t)}catch(e){console.error(e)}finally{m(!1)}};return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 py-4 sm:py-8",children:(0,r.jsx)("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6 lg:p-8",children:[(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-900 mb-2 text-center",dangerouslySetInnerHTML:{__html:a("update_information.title")}})}),(0,r.jsx)(d,{config:R,formData:i,onChange:(e,t)=>{l(a=>({...a,[e]:t}))},onSubmit:U,isLoading:c,isDataLoading:j,onCancel:()=>{e.push("/start-test")},showRecaptcha:!0,recaptchaVerified:C.isVerified,recaptchaError:C.error||void 0,onRecaptchaVerify:C.verify,onRecaptchaError:C.setError,recaptcha:C})]})})})}function C(){return(0,r.jsx)(n.Suspense,{fallback:(0,r.jsx)("div",{children:"Loading..."}),children:(0,r.jsx)(k,{})})}},6413:(e,t,a)=>{Promise.resolve().then(a.bind(a,6042))},7101:(e,t,a)=>{"use strict";a.d(t,{$:()=>n});var r=a(5155);a(2115);let n=e=>{let{children:t,onClick:a,type:n="button",variant:o="primary",size:i="md",disabled:l=!1,loading:s=!1,className:c=""}=e,d="".concat("inline-flex items-center justify-center font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"," ").concat({primary:"bg-blue-500 hover:bg-blue-600 text-white focus:ring-blue-500",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-900 focus:ring-gray-400",danger:"bg-red-500 hover:bg-red-600 text-white focus:ring-red-500"}[o]," ").concat({sm:"px-3 py-2 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[i]," ").concat(c);return(0,r.jsxs)("button",{type:n,onClick:a,disabled:l||s,className:d,children:[s&&(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t]})}},8720:(e,t,a)=>{"use strict";a.d(t,{c:()=>o});var r=a(2115),n=a(63);function o(){let e=(0,n.useParams)(),[t,o]=(0,r.useState)({}),[i,l]=(0,r.useState)(!0),[s,c]=(0,r.useState)(null),d=(null==e?void 0:e.lang)||"en";return(0,r.useEffect)(()=>{(async()=>{try{l(!0),c(null);let e=await a(5915)("./".concat(d,".json"));o(e.default||e)}catch(e){if(console.error("Error loading translations:",e),c("Failed to load translations"),"en"!==d)try{let e=await a.e(92).then(a.t.bind(a,7092,19));o(e.default||e)}catch(e){console.error("Error loading fallback translations:",e)}}finally{l(!1)}})()},[d]),{t:function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(i)return a;let r=e.split("."),n=t;for(let e of r)if(!n||"object"!=typeof n||!(e in n))return a;else n=n[e];return"string"==typeof n?n:a},f:e=>{try{return new Intl.NumberFormat(d).format(e)}catch(t){return e.toString()}},d:e=>{try{return new Intl.DateTimeFormat(d).format(e)}catch(t){return e.toLocaleDateString()}},locale:d,isLoading:i,error:s}}}},e=>{e.O(0,[441,255,358],()=>e(e.s=6413)),_N_E=e.O()}]);